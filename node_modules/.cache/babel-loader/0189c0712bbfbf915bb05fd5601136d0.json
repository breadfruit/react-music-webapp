{"ast":null,"code":"var _jsxFileName = \"/Users/macos/Desktop/react-music-webapp/src/baseUI/scroll/index.js\",\n    _s = $RefreshSig$();\n\nimport React, { forwardRef, useState, useEffect, useRef, useImperativeHandle } from \"react\";\nimport PropTypes from \"prop-types\";\nimport BScroll from \"better-scroll\";\nimport styled from 'styled-components';\nimport Loading from '../loading/index';\nimport Loading2 from '../loading-v2/index';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst ScrollContainer = styled.div`\n  width: 100%;\n  height: 100%;\n  overflow: hidden;\n`; //函数组件，别的组件不读到ref\n\n_c = ScrollContainer;\nconst Scroll = /*#__PURE__*/forwardRef(_c2 = _s((props, ref) => {\n  _s();\n\n  const [bScroll, setBScroll] = useState();\n  const scrollContaninerRef = useRef();\n  const {\n    direction,\n    click,\n    refresh,\n    pullUpLoading,\n    pullDownLoading,\n    bounceTop,\n    bounceBottom\n  } = props;\n  const {\n    pullUp,\n    pullDown,\n    onScroll\n  } = props;\n  useEffect(() => {\n    const scroll = new BScroll(scrollContaninerRef.current, {\n      scrollX: direction === \"horizental\",\n      scrollY: direction === \"vertical\",\n      probeType: 3,\n      click: click,\n      bounce: {\n        top: bounceTop,\n        bottom: bounceBottom\n      }\n    });\n    setBScroll(scroll);\n    return () => {\n      setBScroll(null);\n    }; // eslint-disable-next-line\n  }, []);\n  useEffect(() => {\n    if (!bScroll || !onScroll) return;\n    bScroll.on('scroll', scroll => {\n      onScroll(scroll);\n    });\n    return () => {\n      bScroll.off('scroll');\n    };\n  }, [onScroll, bScroll]);\n  useEffect(() => {\n    if (!bScroll || !pullUp) return;\n    bScroll.on('scrollEnd', () => {\n      //判断是否滑动到了底部\n      if (bScroll.y <= bScroll.maxScrollY + 100) {\n        pullUp();\n      }\n    });\n    return () => {\n      bScroll.off('scrollEnd');\n    };\n  }, [pullUp, bScroll]);\n  useEffect(() => {\n    if (!bScroll || !pullDown) return;\n    bScroll.on('touchEnd', pos => {\n      //判断用户的下拉动作\n      if (pos.y > 50) {\n        pullDown();\n      }\n    });\n    return () => {\n      bScroll.off('touchEnd');\n    };\n  }, [pullDown, bScroll]);\n  useEffect(() => {\n    if (refresh && bScroll) {\n      bScroll.refresh();\n    }\n  });\n  useImperativeHandle(ref, () => ({\n    refresh() {\n      if (bScroll) {\n        bScroll.refresh();\n        bScroll.scrollTo(0, 0);\n      }\n    },\n\n    getBScroll() {\n      if (bScroll) {\n        return bScroll;\n      }\n    }\n\n  }));\n  const PullUpdisplayStyle = pullUpLoading ? {\n    display: \"\"\n  } : {\n    display: \"none\"\n  };\n  const PullDowndisplayStyle = pullDownLoading ? {\n    display: \"\"\n  } : {\n    display: \"none\"\n  };\n  return /*#__PURE__*/_jsxDEV(ScrollContainer, {\n    ref: scrollContaninerRef,\n    children: [props.children, /*#__PURE__*/_jsxDEV(\"pullUpLoading\", {\n      style: PullUpdisplayStyle,\n      children: /*#__PURE__*/_jsxDEV(Loading, {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 103,\n        columnNumber: 47\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 103,\n      columnNumber: 5\n    }, this), /*#__PURE__*/_jsxDEV(\"pullDownLoading\", {\n      style: PullDowndisplayStyle,\n      children: /*#__PURE__*/_jsxDEV(Loading, {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 105,\n        columnNumber: 51\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 105,\n      columnNumber: 5\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 100,\n    columnNumber: 5\n  }, this);\n}, \"xv1Kq+IZIM0YGUo9seEr3h4Kqwk=\", false, function () {\n  return [useImperativeHandle];\n}));\n_c3 = Scroll;\nScroll.defaultProps = {\n  direction: \"vertical\",\n  click: true,\n  refresh: true,\n  onScroll: null,\n  pullUpLoading: false,\n  pullDownLoading: false,\n  pullUp: null,\n  pullDown: null,\n  bounceTop: true,\n  bounceBottom: true\n};\nScroll.propTypes = {\n  direction: PropTypes.oneOf(['vertical', 'horizental']),\n  refresh: PropTypes.bool,\n  onScroll: PropTypes.func,\n  pullUp: PropTypes.func,\n  pullDown: PropTypes.func,\n  pullUpLoading: PropTypes.bool,\n  pullDownLoading: PropTypes.bool,\n  bounceTop: PropTypes.bool,\n  //是否支持向上吸顶\n  bounceBottom: PropTypes.bool //是否支持向上吸顶\n\n};\nexport default Scroll;\n\nvar _c, _c2, _c3;\n\n$RefreshReg$(_c, \"ScrollContainer\");\n$RefreshReg$(_c2, \"Scroll$forwardRef\");\n$RefreshReg$(_c3, \"Scroll\");","map":{"version":3,"sources":["/Users/macos/Desktop/react-music-webapp/src/baseUI/scroll/index.js"],"names":["React","forwardRef","useState","useEffect","useRef","useImperativeHandle","PropTypes","BScroll","styled","Loading","Loading2","ScrollContainer","div","Scroll","props","ref","bScroll","setBScroll","scrollContaninerRef","direction","click","refresh","pullUpLoading","pullDownLoading","bounceTop","bounceBottom","pullUp","pullDown","onScroll","scroll","current","scrollX","scrollY","probeType","bounce","top","bottom","on","off","y","maxScrollY","pos","scrollTo","getBScroll","PullUpdisplayStyle","display","PullDowndisplayStyle","children","defaultProps","propTypes","oneOf","bool","func"],"mappings":"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","sourcesContent":["import React, { forwardRef, useState,useEffect, useRef, useImperativeHandle } from \"react\"\nimport PropTypes from \"prop-types\"\nimport BScroll from \"better-scroll\"\nimport styled from 'styled-components';\nimport Loading from '../loading/index';\nimport Loading2 from '../loading-v2/index';\nconst ScrollContainer = styled.div`\n  width: 100%;\n  height: 100%;\n  overflow: hidden;\n`\n\n//函数组件，别的组件不读到ref\nconst Scroll = forwardRef((props, ref) => {\n  const [bScroll, setBScroll] = useState();\n\n  const scrollContaninerRef = useRef();\n\n  const { direction, click, refresh, pullUpLoading, pullDownLoading, bounceTop, bounceBottom } = props;\n\n  const { pullUp, pullDown, onScroll } = props;\n\n  useEffect(() => {\n    const scroll = new BScroll(scrollContaninerRef.current, {\n      scrollX: direction === \"horizental\",\n      scrollY: direction === \"vertical\",\n      probeType: 3,\n      click: click,\n      bounce:{\n        top: bounceTop,\n        bottom: bounceBottom\n      }\n    });\n    setBScroll(scroll);\n    return () => {\n      setBScroll(null);\n    }\n    // eslint-disable-next-line\n  }, []);\n\n  useEffect(() => {\n    if(!bScroll || !onScroll) return;\n    bScroll.on('scroll', (scroll) => {\n      onScroll(scroll);\n    })\n    return () => {\n      bScroll.off('scroll');\n    }\n  }, [onScroll, bScroll]);\n\n  useEffect(() => {\n    if(!bScroll || !pullUp) return;\n    bScroll.on('scrollEnd', () => {\n      //判断是否滑动到了底部\n      if(bScroll.y <= bScroll.maxScrollY + 100){\n        pullUp();\n      }\n    });\n    return () => {\n      bScroll.off('scrollEnd');\n    }\n  }, [pullUp, bScroll]);\n\n  useEffect(() => {\n    if(!bScroll || !pullDown) return;\n    bScroll.on('touchEnd', (pos) => {\n      //判断用户的下拉动作\n      if(pos.y > 50) {\n        pullDown();\n      }\n    });\n    return () => {\n      bScroll.off('touchEnd');\n    }\n  }, [pullDown, bScroll]);\n\n\n  useEffect(() => {\n    if(refresh && bScroll){\n      bScroll.refresh();\n    }\n  });\n\n  useImperativeHandle(ref, () => ({\n    refresh() {\n      if(bScroll) {\n        bScroll.refresh();\n        bScroll.scrollTo(0, 0);\n      }\n    },\n    getBScroll() {\n      if(bScroll) {\n        return bScroll;\n      }\n    }\n  }));\n  const PullUpdisplayStyle = pullUpLoading ? {display: \"\"} : { display:\"none\" };\n  const PullDowndisplayStyle = pullDownLoading ? {display: \"\"} : {display: \"none\"}\n  return (\n    <ScrollContainer ref={scrollContaninerRef}>\n      {props.children}\n      {/* 向上滑 */}\n    <pullUpLoading style={PullUpdisplayStyle}><Loading></Loading></pullUpLoading>\n      {/* 向下滑 */}\n    <pullDownLoading style={PullDowndisplayStyle}><Loading></Loading></pullDownLoading>\n    </ScrollContainer>\n  );\n})\n\nScroll.defaultProps = {\n  direction: \"vertical\",\n  click: true,\n  refresh: true,\n  onScroll:null,\n  pullUpLoading: false,\n  pullDownLoading: false,\n  pullUp: null,\n  pullDown: null,\n  bounceTop: true,\n  bounceBottom: true\n};\n\nScroll.propTypes = {\n  direction: PropTypes.oneOf(['vertical', 'horizental']),\n  refresh: PropTypes.bool,\n  onScroll: PropTypes.func,\n  pullUp: PropTypes.func,\n  pullDown: PropTypes.func,\n  pullUpLoading: PropTypes.bool,\n  pullDownLoading: PropTypes.bool,\n  bounceTop: PropTypes.bool,//是否支持向上吸顶\n  bounceBottom: PropTypes.bool//是否支持向上吸顶\n};\n\nexport default Scroll;"]},"metadata":{},"sourceType":"module"}