{"ast":null,"code":"var _jsxFileName = \"/Users/macos/Desktop/react-music-webapp/src/application/SongList/index.js\",\n    _s = $RefreshSig$();\n\nimport React, { useState, useEffect } from 'react';\nimport { SongList, SongItem } from \"./style\";\nimport { getName } from '../../api/utils';\nimport { ONE_PAGE_COUNT } from '../../api/config';\nimport { connect } from 'react-redux';\nimport { changePlayList, changeCurrentIndex, changeSequecePlayList } from '../Player/store/actionCreators';\nimport { getOneMusicPlayerRequest, getImageUrlRequest } from '../../api/request';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst SongsList = /*#__PURE__*/React.forwardRef(_c = _s((props, refs) => {\n  _s();\n\n  const [startIndex, setStartIndex] = useState(0);\n  const [currentMusicPlayer, setCurrentMusicPlayer] = useState('');\n  const [currentMusicImage, setCurrentMusicImage] = useState('');\n  const {\n    songs,\n    collectCount,\n    showCollect,\n    loading = false,\n    usePageSplit\n  } = props;\n  const {\n    musicAnimation\n  } = props;\n  const {\n    changePlayListDispatch,\n    changeCurrentIndexDispatch,\n    changeSequecePlayListDispatch\n  } = props;\n  const totalCount = songs.length;\n  useEffect(() => {\n    if (!loading) return;\n    if (startIndex + 1 + ONE_PAGE_COUNT >= totalCount) return;\n    setStartIndex(startIndex + ONE_PAGE_COUNT);\n  }, [loading, startIndex, totalCount]);\n\n  const selectItem = (e, index) => {\n    console.log('我是singerlist----', songs[index]);\n    let cursong = songs[index]; //先获取歌曲播放链接\n\n    getOneMusicPlayerRequest(cursong.mid).then(res => {\n      let data = res.response.data.playUrl;\n\n      if (!data.error) {\n        data = data.url;\n      } else {\n        data = data.error;\n      }\n\n      setCurrentMusicPlayer(data);\n    }); //修改当前播放列表\n\n    changePlayListDispatch(songs); //加入播放歌单\n\n    changeSequecePlayListDispatch(songs); //修改当前播放歌曲的id\n\n    changeCurrentIndexDispatch(index);\n    musicAnimation(e.nativeEvent.clientX, e.nativeEvent.clientY);\n  };\n\n  let songList = list => {\n    let res = []; // 判断页数是否超过总数\n\n    let end = usePageSplit ? startIndex + ONE_PAGE_COUNT : list.length;\n\n    for (let i = 0; i < end; i++) {\n      if (i >= list.length) break;\n      let item = list[i];\n      res.push(\n      /*#__PURE__*/\n      // 对每一首歌曲提前获取歌曲的播放链接\n      _jsxDEV(\"li\", {\n        onClick: e => selectItem(e, i),\n        children: [/*#__PURE__*/_jsxDEV(\"span\", {\n          className: \"index\",\n          children: i + 1\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 64,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"info\",\n          children: [/*#__PURE__*/_jsxDEV(\"span\", {\n            children: item.name\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 66,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n            children: getName(item)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 67,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 65,\n          columnNumber: 11\n        }, this)]\n      }, item.id, true, {\n        fileName: _jsxFileName,\n        lineNumber: 63,\n        columnNumber: 9\n      }, this));\n    }\n\n    return res;\n  };\n\n  const collect = count => {\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"add_list\",\n      children: [/*#__PURE__*/_jsxDEV(\"i\", {\n        className: \"iconfont\",\n        children: \"\\uE62D\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 82,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n        children: [\"\\u6536\\u85CF(\", Math.floor(count / 1000) / 10, \"\\u4E07)\"]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 83,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 81,\n      columnNumber: 7\n    }, this) // <div className=\"isCollected\">\n    //   <span>已收藏({Math.floor(count/1000)/10}万)</span>\n    // </div>\n    ;\n  };\n\n  return /*#__PURE__*/_jsxDEV(SongList, {\n    ref: refs,\n    showBackground: props.showBackground,\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"first_line\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"play_all\",\n        onClick: e => selectItem(e, 0),\n        children: [/*#__PURE__*/_jsxDEV(\"i\", {\n          className: \"iconfont\",\n          children: \"\\uE6E3\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 94,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n          children: [\"\\u64AD\\u653E\\u5168\\u90E8 \", /*#__PURE__*/_jsxDEV(\"span\", {\n            className: \"sum\",\n            children: [\"(\\u5171\", totalCount, \"\\u9996)\"]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 95,\n            columnNumber: 22\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 95,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 93,\n        columnNumber: 9\n      }, this), showCollect ? collect(collectCount) : null]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 92,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(SongItem, {\n      children: songList(songs)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 99,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 91,\n    columnNumber: 5\n  }, this);\n}, \"iVg9nkHylRiNW5xwY96RWzQRtLA=\")); // 映射Redux全局的state到组件的props上\n\n_c2 = SongsList;\n\nconst mapStateToProps = state => ({\n  fullScreen: state.getIn(['player', 'fullScreen']),\n  playing: state.getIn(['player', 'playing']),\n  currentSong: state.getIn(['player', 'currentSong']),\n  scrollY: state.getIn(['album', 'scrollY'])\n}); // 映射dispatch到props上\n\n\nconst mapDispatchToProps = dispatch => {\n  return {\n    changePlayListDispatch(data) {\n      dispatch(changePlayList(data));\n    },\n\n    changeCurrentIndexDispatch(data) {\n      dispatch(changeCurrentIndex(data));\n    },\n\n    changeSequecePlayListDispatch(data) {\n      dispatch(changeSequecePlayList(data));\n    }\n\n  };\n}; // 将ui组件包装成容器组件\n\n\nexport default connect(mapStateToProps, mapDispatchToProps)( /*#__PURE__*/React.memo(SongsList));\n\nvar _c, _c2;\n\n$RefreshReg$(_c, \"SongsList$React.forwardRef\");\n$RefreshReg$(_c2, \"SongsList\");","map":{"version":3,"sources":["/Users/macos/Desktop/react-music-webapp/src/application/SongList/index.js"],"names":["React","useState","useEffect","SongList","SongItem","getName","ONE_PAGE_COUNT","connect","changePlayList","changeCurrentIndex","changeSequecePlayList","getOneMusicPlayerRequest","getImageUrlRequest","SongsList","forwardRef","props","refs","startIndex","setStartIndex","currentMusicPlayer","setCurrentMusicPlayer","currentMusicImage","setCurrentMusicImage","songs","collectCount","showCollect","loading","usePageSplit","musicAnimation","changePlayListDispatch","changeCurrentIndexDispatch","changeSequecePlayListDispatch","totalCount","length","selectItem","e","index","console","log","cursong","mid","then","res","data","response","playUrl","error","url","nativeEvent","clientX","clientY","songList","list","end","i","item","push","name","id","collect","count","Math","floor","showBackground","mapStateToProps","state","fullScreen","getIn","playing","currentSong","scrollY","mapDispatchToProps","dispatch","memo"],"mappings":"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","sourcesContent":["import React, {useState, useEffect } from 'react';\nimport { SongList, SongItem } from \"./style\";\nimport { getName } from '../../api/utils';\nimport { ONE_PAGE_COUNT } from '../../api/config';\nimport { connect } from 'react-redux';\nimport { changePlayList, changeCurrentIndex, changeSequecePlayList } from '../Player/store/actionCreators';\nimport { getOneMusicPlayerRequest, getImageUrlRequest } from '../../api/request'\n\nconst SongsList = React.forwardRef((props, refs)=> {\n\n  const [startIndex, setStartIndex] = useState(0);\n  const [currentMusicPlayer, setCurrentMusicPlayer] = useState('');\n  const [currentMusicImage, setCurrentMusicImage] = useState('')\n \n  const { songs, collectCount, showCollect,loading=false, usePageSplit } = props;\n\n  const { musicAnimation } = props;\n\n  const { changePlayListDispatch, changeCurrentIndexDispatch, changeSequecePlayListDispatch } = props;\n  const totalCount = songs.length;\n\n  useEffect(() => {\n    if(!loading) return;\n    if(startIndex + 1 + ONE_PAGE_COUNT >= totalCount)\n      return;\n    setStartIndex(startIndex + ONE_PAGE_COUNT);\n  }, [loading, startIndex, totalCount]);\n\n  const selectItem = (e, index) => {\n    console.log('我是singerlist----', songs[index])\n    let cursong = songs[index];\n    //先获取歌曲播放链接\n    getOneMusicPlayerRequest(cursong.mid).then(res => {\n      let data =  res.response.data.playUrl;\n      if(!data.error) {\n        data = data.url;\n      }else {\n        data = data.error\n      }\n      setCurrentMusicPlayer(data)\n    })\n  \n\n\n    //修改当前播放列表\n    changePlayListDispatch(songs);\n    //加入播放歌单\n    changeSequecePlayListDispatch(songs);\n    //修改当前播放歌曲的id\n    changeCurrentIndexDispatch(index);\n    musicAnimation(e.nativeEvent.clientX, e.nativeEvent.clientY);\n  }\n\n  let songList = (list) => {\n    let res = [];\n    // 判断页数是否超过总数\n    let end = usePageSplit ? startIndex + ONE_PAGE_COUNT : list.length;\n    for(let i = 0; i < end; i++) {\n      if(i >= list.length) break;\n      let item = list[i];\n      res.push(\n        // 对每一首歌曲提前获取歌曲的播放链接\n        <li key={item.id} onClick={(e) => selectItem(e, i)}>\n          <span className=\"index\">{i + 1}</span>\n          <div className=\"info\">\n            <span>{item.name}</span>\n            <span>\n              \n              {/* { item.ar ? getName(item.ar): getName(item.artists) } - { item.al ? item.al.name : item.album.name} */}\n              {getName(item)}\n            </span>\n          </div>\n        </li>\n      )\n    }\n    return res;\n  };\n\n  const collect = (count) => {\n    return  (\n      <div className=\"add_list\">\n        <i className=\"iconfont\">&#xe62d;</i>\n        <span>收藏({Math.floor(count/1000)/10}万)</span>\n      </div>\n      // <div className=\"isCollected\">\n      //   <span>已收藏({Math.floor(count/1000)/10}万)</span>\n      // </div>\n    )\n  };\n  return (\n    <SongList ref={refs} showBackground={props.showBackground}>\n      <div className=\"first_line\">\n        <div className=\"play_all\" onClick={(e) => selectItem(e, 0)}>\n          <i className=\"iconfont\">&#xe6e3;</i>\n          <span>播放全部 <span className=\"sum\">(共{totalCount}首)</span></span>\n        </div>\n        { showCollect ? collect(collectCount) : null}\n      </div>\n      <SongItem>\n        { songList(songs) }\n      </SongItem>\n    </SongList>\n  )\n});\n\n\n// 映射Redux全局的state到组件的props上\nconst mapStateToProps = (state) => ({\n  fullScreen: state.getIn(['player', 'fullScreen']),\n  playing: state.getIn(['player', 'playing']),\n  currentSong: state.getIn(['player', 'currentSong']),\n  scrollY: state.getIn(['album', 'scrollY'])  \n});\n// 映射dispatch到props上\nconst mapDispatchToProps = (dispatch) => {\n  return {\n    changePlayListDispatch(data){\n      dispatch(changePlayList(data));\n    },\n    changeCurrentIndexDispatch(data) {\n      dispatch(changeCurrentIndex(data));\n    },\n    changeSequecePlayListDispatch(data) {\n      dispatch(changeSequecePlayList(data))\n    }\n  }\n};\n\n\n// 将ui组件包装成容器组件\nexport default connect(mapStateToProps, mapDispatchToProps)(React.memo(SongsList));"]},"metadata":{},"sourceType":"module"}